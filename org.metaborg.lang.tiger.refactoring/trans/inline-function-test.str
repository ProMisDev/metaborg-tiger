module inline-function-test

imports 
	signatures/-
	nabl2/api
	pp
	libspoofax/stratego/debug
	renaming
	inline-function
	
rules // rules called by spt
  inline-call-test : ast -> result
    where
    	analysis := <nabl2-get-ast-analysis> ast;
      <not(nabl2-analysis-has-errors)> analysis
    with
      target-call := <collect-one(get-call-test(|"plus"))> ast
      ; target-dec-occ := <collect-one(get-function-declaration(|analysis, target-call)) > ast
      ; (params, body) := <collect-one(get-function(|target-dec-occ))> ast
      ; result := <oncetd(replace-this-call(|target-call, body, params))> ast
      
rules
  get-call-test(|target-name): Call(name, args) -> name
	where
		<eq> (<strip-annos> target-name, <strip-annos> name)
    

 		